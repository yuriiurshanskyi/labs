## Lab_5: Автоматизація за допомогою Makefile VS Docker Compose
### Pre-requirements:
- віртуальна машина (Ubuntu) з інстальованим Docker / docker-compose, make;
### What to do.
1. Прочитати про `docker-compose` можна за [посиланням](https://docs.docker.com/compose/);
2. Коли необхідно створити простий веб сайт на Python найчастіше використовують бібліотеку `Flask`. Прочитати про неї можна за [посиланням](https://flask-russian-docs.readthedocs.io/ru/latest/quickstart.html); 
3. Наше завдання: за допомогою Docker автоматизувати розгортання веб сайту з усіма супутніми процесами. Це зробимо двома шляхами:
    - за допомогою `Makefile`;
    - за допомогою `docker-compose.yaml`;
4. Першим розглянемо варіант з `Makefile`, але для цього створимо робочий проект. 
5. Створіть папку `my_app` в якій буде знаходитись Ваш проект. Створіть папку `tests` де будуть тести на перевірку працездатності Вашого проекту. Скопіюйте файли з цього репозиторію у відповідні папки Вашого. Ознайомтесь із вмістом кожного з файлів. Зверніть увагу на файл `requirements.txt` у папці проекту та тестах. Даний файл буде мітити залежності для нашого проекту (продивіться контен цього файлу, що Він містить?);
6. Ми можемо спробувати чи проект є працездатним перейшовши у папку та після ініціалізації середовища виконати команди записані нижче:
    ```bash
    pipenv --python 3.7
    pipenv install -r requirements.txt
    pipenv run python app.py
    ```
    - так само можна ініціалузувати середовище для тестів у іншій вкладці шелу та запустити їх командою (вкажіть чи тести пройшли успішно?):
    ```bash
    pipenv run pytest test_app.py --url http://localhost:5000
    ```
    - звертіть увагу, що у Вас автоматично створяться файли `Pipfile` та `Pipfile.lock`, а також на хост машині буде створена папка `.venv` (вона може бути у home папці). Після зупинки проекту *ВИДАЛІТЬ ЇХ, і НЕ комітьте*;
    - перевірте роботу сайту перейшовши на кожну із сторінок (знайдете їх в програмі `app.py`).    
7. _Видаліть файли які постворювались після тестового запуску_. Щоб наше середовище було чистим, все буде створюватись і виконуватись всередині Docker. Створіть два `Dockerfile` з іменами як у цьому репозиторію та `Makefile` який допоможе автоматизувати процес розгортання;
8. Ознайомтесь із вмістом `Dockerfile` та `Makefile` та його директивами. Розпишіть у Вашому `README.md` файлі що робить кожна директива `Makefile`;
9. Для початку, використовуючи команду `make` створіть Docker імеджі для додатку та для тестів (надіюсь Ви розібрались з директивами `Makefile`). Теги для цих імеджів мають бути з Вашим Docker Hub репозиторієм. Запустіть додаток та перейшовши в іншу вкладку шелу запустіть тести. Переконайтесь що тести пройшли успішно;
    - перевірте роботу веб-сайту. Що відображається на кожній сторінці сайту (зробіть скріни сторінок та вставте до Вашого репозиторію)?
10. Зупиніть проект натиснувши `Ctrl+C` та почистіть всі ресурси Docker за допомогою `make`.
11. Створіть директиву в `Makefile` для завантаження створених імеджів у Ваш Docker Hub репозиторій. Завантажте імеджі до Вашого репозиторію;
12. Також видаліть створені та закачані імеджі. Команда `docker images` має виводити пусті рядки. Створіть директиву в `Makefile` яка автоматизує процес видалення Ваших імеджів.
13. Перейдемо до іншого варіанту з використанням `docker-compose.yaml`. Для цього створіть даний файл у кореновій папці проекту та заповніть вмістом з прикладу. Проект який ми будемо розгортити за цим варіантом трохи відрізняється від першого тим що у нього зявляється дві мережі (назвіть їх та вкажіть для чого це потрібно?);
14. Перевірте чи Docker-compose встановлений та працює у Вашій системі, а далі просто запустіть `docker-compose`;  
    ```bash
    docker-compose version
    docker-compose -p lab5 up
    ```
15. Перевірте чи працює веб-сайт. На яку адресу потрібнр зайти у браузері?
16. Перевірте чи компоуз створив докер імеджі (які Ви мали видалити перед цим). Які теги мають імеджі? Змініть їх на власний репозиторій і перезапустіть `docker-compose` (почистити імеджі без тегів можна за допомогою директиви в `Makefile`, Ви нею скористались?).
17. Зупиніть проект натиснувши `Ctrl+C` і почистіть ресурси створені компоуз `docker-compose down`;
18. Завантажте створені імеджі до Docker Hub репозиторієм за допомого команди:
    ```bash
    docker-compose push
    ```
19. Що на Вашу думку краще використовувати `Makefile` чи `docker-compose.yaml`?
20. (Завдання) Оскільки Ви навчились створювати `docker-compose.yaml` у цій лабораторній то потрібно:
    - створити `docker-compose.yaml` для лабораторної №4. Компоуз повинен створити два імеджі для Django сайту та моніторингу, а також їх успішно запустити (зверніть увагу на мережу);
21. Після успішного виконання роботи відредагуйте Ваш персональний _README.md_ у цьому репозиторію та створіть pull request.